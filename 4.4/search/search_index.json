{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"The Control Center for VATSIM Subdivisons","text":"Training, mentoring, bookings \u2014\u00a0made easy <ul> <li> <p> Try it out in 5 minutes</p> <p>Run Control Center with <code>docker compose</code> and get up and running in minutes</p> <p> Getting started</p> </li> <li> <p> Learn what it can do</p> <p>Focus on training new virtual ATC students and handle position bookings</p> <p> Usage</p> </li> <li> <p> Customise to your division</p> <p>Change the colors, fonts, language, icons, logo and more with a few lines</p> <p> Theming</p> </li> <li> <p> Install it in production</p> <p>Production installation for your own subdivision and get running with a self-hosted instance</p> <p> Installation</p> </li> <li> <p> Open Source, GPL</p> <p>Control Center is licensed under the GPL-3.0 and freely available on GitHub</p> <p> License</p> </li> <li> <p> Make it better</p> <p>Join our community and help by contributing to Control Center itself</p> <p> Contribute</p> </li> </ul>"},{"location":"api/","title":"API","text":""},{"location":"api/#api-endpoints","title":"API Endpoints","text":""},{"location":"api/#get-apiusers","title":"GET <code>/api/users</code>","text":"<p>Returns a list of users with selected data. To reduce latency and response size, this endpoint is based on providing data you explicitly ask for.</p> Variable Default value Explanation include null Array of relations to include onlyAtcActive false Only return users with an active ATC rating"},{"location":"api/#include-relations","title":"Include relations","text":"<p>Parameters which filter the user selection</p> Relation Explanation allUsers Include all users in your division who have logged into Control Center endorsements Include user's endorsements roles Include user's Control Center roles training Include user's with active training <p>Parameters to add additional fields to the result</p> Relation Explanation name Include user's full name email Include user's email divisions Include user's region, division and subdivision"},{"location":"api/#example-return-with-all-parameters","title":"Example return with all parameters","text":"<pre><code>{\n    \"id\": 10000001,\n    \"email\": \"auth.dev1@vatsim.net\",\n    \"first_name\": \"Web\",\n    \"last_name\": \"One\",\n    \"rating\": \"OBS\",\n    \"region\": \"APAC\",\n    \"division\": \"PAC\",\n    \"subdivision\": \"SCA\",\n    \"atc_active\": false,\n    \"endorsements\": {\n        \"visiting\": [\n            {\n                \"valid_from\": \"2023-09-16T20:53:32.000000Z\",\n                \"valid_to\": null,\n                \"rating\": \"C3\",\n                \"areas\": [\n                    \"Finland\"\n                ]\n            }\n        ],\n        \"examiner\": [\n            {\n                \"valid_from\": \"2023-09-16T20:53:27.000000Z\",\n                \"valid_to\": null,\n                \"rating\": \"S3\",\n                \"areas\": [\n                    \"Finland\"\n                ]\n            }\n        ],\n        \"training\": {\n            \"solo\": null,\n            \"s1\": null\n        },\n        \"masc\": [\n            {\n                \"valid_from\": \"2023-09-16T20:53:00.000000Z\",\n                \"valid_to\": null,\n                \"rating\": \"MAE ENGM TWR\"\n            }\n        ]\n    },\n    \"roles\": {\n        \"Denmark\": [\n            \"Administrator\",\n            \"Moderator\",\n            \"Mentor\"\n        ],\n        \"Finland\": null,\n        \"Iceland\": null,\n        \"Norway\": null,\n        \"Sweden\": null\n    },\n    \"training\": [\n        {\n            \"area\": \"Denmark\",\n            \"type\": \"Transfer\",\n            \"status\": 0,\n            \"status_description\": \"In queue\",\n            \"created_at\": \"2021-12-16T10:00:51.000000Z\",\n            \"started_at\": null,\n            \"ratings\": [\n                \"S3\"\n            ]\n        }\n    ]\n}\n</code></pre>"},{"location":"api/#get-post-patch-and-delete-apibookings","title":"GET, POST, PATCH and DELETE <code>/api/bookings</code>","text":"<p>Will be documented one day.</p>"},{"location":"api/#api-endpoints-deprecated","title":"API Endpoints (deprecated)","text":"<p>Older endpoints that will be replaced with the <code>api/users</code> endpoint. Do not use these if you're creating a new integration.</p> <ul> <li>GET users assigned roles and their area <code>/api/roles</code></li> <li>GET users holding Major Airport / Special Center endorsements <code>/api/endorsements/masc</code></li> <li>GET users holding Training endorsements <code>/api/endorsements/training/solo</code> &amp; <code>/api/endorsements/training/s1</code></li> <li>GET users holding Examiner endorsements <code>/api/endorsements/examiner</code></li> <li>GET users holding Visiting endorsements <code>/api/endorsements/visiting</code></li> </ul>"},{"location":"api/#authentication","title":"Authentication","text":"<p>To create an API key use <code>php artisan create:apikey</code>, use the returned token as authentication bearer.</p> <p>Executing commands in containers</p> <p>If you're using a container you need to use execute the command inside of the container. For example, if you're using Docker you must prefix the command with <code>docker exec</code> and specify the container name. Here's an example where we assume that the container is <code>control-center</code>:</p> <pre><code>docker exec -it --user www-data control-center COMMAND [ARGUMENTS...]\n</code></pre>"},{"location":"background-jobs/","title":"Background jobs","text":"<p>To support all the functionality, Control Center relies on scheduled background jobs for certain tasks. These tasks must run regularly for Control Center to work as expected.</p>"},{"location":"background-jobs/#scheduled-tasks","title":"Scheduled tasks","text":"<p>A selection of important scheduled tasks include:</p> <ul> <li>All trainings with status In Queue or Pre-Training are given a continued interest request each month, and a reminder after a week.</li> <li>ATC Active is flag given based on ATC activity. Refreshes daily with data from VATSIM Data API. It counts the hours from today's date and backwards according to the length of qualification period.</li> <li>Daily member cleanup, if a member leaves the division, their training will be automatically closed. Same for mentors. Does not apply to visitors.</li> </ul>"},{"location":"contribute/","title":"Contribute","text":"<p>Interested in hacking on Control Center? Adding a new, favourite feature? Say no more.</p>"},{"location":"contribute/#running-the-development-environment","title":"Running the development environment","text":"<p>To develop Control Center, we recommend running the docker container with the included <code>docker-compose.yaml</code> file inside <code>.devcontainer</code> folder. Note that the dev-container setup is a work in-progress, therefore we recommend using the Docker compose file. This also binds the whole application folder into the container so you can edit the files locally and they'll be updated in the container.</p>"},{"location":"contribute/#setup-inside-container","title":"Setup inside container","text":"<ol> <li>Run <code>composer install</code> to install all dependencies</li> <li>Run <code>npm install</code> to install all dependencies</li> <li>Run <code>npm run build</code> to compile the assets</li> <li>Run <code>php artisan migrate</code> to setup the database</li> </ol> <p>If you need test data, you can also seed the database with <code>php artisan db:seed</code>.</p> <p>If you encounter permissions errors you might want to <code>chown -R www-data:www-data /app</code> and <code>chmod -R o+w /app</code> to ensure the webserver can write to the storage folder.</p>"},{"location":"contribute/#run-unit-tests","title":"Run unit tests","text":""},{"location":"contribute/#first-run","title":"First run","text":"<p>On first run you might need to setup the testing sqlite database first. Run the command <code>php artisan migrate --database sqlite-testing</code> to setup the database.</p>"},{"location":"contribute/#test","title":"Test","text":"<p>To run the PHP unit tests use:</p> <pre><code>php artisan test\n</code></pre> <p>To create new tests, you can use the helper, which by default creates feature tests rather than unit tests:</p> <pre><code>php artisan make:test\n</code></pre> <p>The tests run with the local SQLite test database, not your development database.</p>"},{"location":"contribute/#quicker-feedback-during-development","title":"Quicker feedback during development","text":"<p>Install the <code>pre-commit</code> project locally and you'll be able to take advantage of our pre-commit hooks. They help you keep formatting consistent and avoid mistakes that'll be caught by the continous integration tests.</p> <p>Tip</p> <p>This isn't required, but recommended to get an improved feedback loop while developing.</p>"},{"location":"contribute/#run-formatting","title":"Run formatting","text":"<p>To run the formatting script that ensures consistent Laravel PHP code use <code>./vendor/bin/pint</code>.</p>"},{"location":"contribute/#conventions","title":"Conventions","text":"<p>Contributions are much appreciated to help everyone evolve this service with fixes and functionalities. We recommend you to fork this repository here on GitHub so you can easily create pull requests back to the main project.</p> <p>To keep a collaborative project in the same style and understandable, it's important to follow some conventions:</p>"},{"location":"contribute/#github-branches","title":"GitHub Branches","text":"<p>We name branches with <code>feat/name-here</code>, <code>fix/name-here</code> or <code>misc/name-here</code>, for instance <code>feat/new-api</code> or <code>fix/mentor-mail</code></p>"},{"location":"contribute/#modelssql","title":"Models/SQL","text":"<ul> <li>MySQL tables are named in plural e.g <code>training_reports</code>, not <code>training_report</code></li> <li>Models are named in singular e.g. <code>Training</code>, not <code>Trainings</code></li> <li>Models names don't have any specific suffix or prefix</li> <li>Models are located in root of <code>App/Models</code> folder.</li> </ul>"},{"location":"contribute/#controllers","title":"Controllers","text":"<ul> <li>Controllers are suffixed with <code>Controller</code>, for instance <code>TrainingController</code></li> <li>Controllers are named in singular e.g. <code>TrainingController</code>, not <code>TrainingsController</code></li> <li>The controllers should mainly consist of the methods of \"7 restful controller actions\" Check out this video</li> </ul>"},{"location":"contribute/#other","title":"Other","text":"<ul> <li>We name our views with blade suffix for clarity, like <code>header.blade.php</code></li> <li>For more in-depth conventions which we try to follow, check out Laravel best practices</li> <li>We tab with 4 spaces for increased readability</li> <li>The service language is UK English</li> </ul>"},{"location":"contribute/#introduction-to-laravel","title":"Introduction to Laravel","text":""},{"location":"contribute/#basics","title":"Basics","text":"<p>This project has a prerequisite that you're familiar with PHP and Object-oriented programming. If you're unfamiliar with Laravel, check out these resources:</p> <ul> <li>Laravel Documentation</li> <li>Free and high-quality Laravel 8 tutorial</li> <li>Laravel essentials in 45 min</li> </ul>"},{"location":"contribute/#workspace","title":"Workspace","text":"<p>Everyone has their own setup for workspace, but if you're new to Laravel and this project, check out our recommendations:</p> <ol> <li>Use Visual Studio Code as editor.</li> <li>Install the following plugins in VS Code.</li> <li>Optionally install this icon pack for some smooth icons.</li> <li>Learn tips and tricks for PHP and Laravel in VS Code in these Laracasts</li> </ol>"},{"location":"custom/","title":"Creating a custom image","text":"<p>Depending on the changes you'd like to make, you may choose to create a variant of Control Center based on the upstream version.</p> <p>Warning</p> <p>Creating a custom variant is limited to people with prior development experience. We recommend that most, if not all, users should use the standard container image.</p> <p>This is the most reliable way to make changes over time, as well as regularly synchronise the changes with the upstream.</p>"},{"location":"getting-started/","title":"Getting Started with Control Center","text":"<p>Welcome aboard the Control Center express! Whether you're a veteran virtual ATC, experienced mentor, a training director or just spreading your wings, we're excited to help you launch Control Center effortlessly. Let's dive into setting it up using <code>docker compose</code>\u2014it's quick, simple, and maybe even fun!</p> <p>In this getting started guide, we'll do the following.</p> <ol> <li> <p>Install Docker Compose: First things first, a quick install if you don't have it.</p> </li> <li> <p>Add the Compose File: Grab the <code>docker-compose.yml</code> file we've prepared.</p> </li> <li> <p>Run Control Center: Start Control Center locally and log in.</p> </li> <li> <p>Be the Admin: Elevate your demonstration user to administrative rights.</p> </li> <li> <p>Clear for takeoff: Voil\u00e0! You're now looking at your very own Control Center dashboard.</p> </li> </ol>"},{"location":"getting-started/#run-a-local-demo-version","title":"Run a local demo version","text":"<p>Before we take off, you'll need Docker and Docker Compose on your system. If they aren't already part of your cockpit, head over to the Docker website and grab the installations. It's a straightforward process that paves the way for a smooth flight.</p> Other container runtimes <p>Alternatively, you might be able to use the Docker CLI together with the Compose plugin with other container runtimes. Some of those runtimes include Lima and Podman, both of which can run on macOS or Linux distributions.</p>"},{"location":"getting-started/#add-the-docker-compose-file","title":"Add the Docker Compose file","text":"<p>The heart of our quick setup is the <code>docker-compose.yml</code> file. This little gem contains all the necessary settings to get Control Center airborne. Here's the file you need:</p> docker-compose.yml<pre><code>---\n# WARNING: This configuration is only for local demonstration purposes!\nversion: '3.3'\nservices:\n  control-center:\n    image: ghcr.io/vatsim-scandinavia/control-center:v4\n    depends_on:\n      db-ready:\n        condition: service_completed_successfully\n    ports:\n      - '8080:80'\n    environment:\n      - DB_HOST=db\n      - DB_USERNAME=root\n      - DB_PASSWORD=root\n      - DB_DATABASE=test\n      - OAUTH_ID=443\n      - OAUTH_SECRET=FdFHEWwYU2QBNUd9x5O6SlY2mFdnxv2AqitfD9pD # (1)!\n      - OAUTH_URL=\"https://auth-dev.vatsim.net\"\n    command: &gt;-\n      sh -c \"php artisan migrate --force; exec apache2-foreground\"\n  db:\n    image: docker.io/library/mariadb:11\n    ports:\n      - 3306:3306\n    environment:\n      MARIADB_DATABASE: test\n      MARIADB_ROOT_PASSWORD: root\n  db-ready:\n    image: atkrad/wait4x\n    command: mysql \"root:root@tcp(db)/test\" -t 10s -i 500ms\n</code></pre> <ol> <li> <p>This uses a pre-existing OAuth2 configuration publicly available at VATSIM's development and testing OAuth server.</p> <p>If you can't log in, first check that you haven't accessed the service via an IP address or a different port. If you still can't log in, you might need to log in to the authentication server and verify that the client ID and secret are correct.</p> </li> </ol> <p>Save this file in your preferred directory; it's your ticket to a hassle-free launch.</p>"},{"location":"getting-started/#launching-control-center","title":"Launching Control Center","text":"<p>With your <code>docker-compose.yml</code> file ready, open your terminal and steer to the directory where the file is docked. Then, initiate the launch sequence with:</p> <pre><code>docker compose up\n</code></pre> <p>This command lifts Control Center into the digital stratosphere, setting up everything you need in a matter of minutes.</p> <p>Info</p> <p>If you're running an older version of Docker or another runtime, replace <code>docker compose</code> with <code>docker-compose</code>.</p>"},{"location":"getting-started/#accessing-your-dashboard","title":"Accessing Your Dashboard","text":"<p>Your Control Center dashboard is now just a click away. Fire up your web browser and navigate to <code>http://localhost:8080</code>.</p> <p>Log in to the testing authentication portal using the CID <code>10000010</code> and password <code>10000010</code>. You'll (hopefully!) be lining up on the dashboard. The dashboard will greet you, ready to manage your control zone center.</p> New to Control Center? <p>If you're just starting out, don't fret. Control Center is designed to be intuitive and user-friendly. We've got plenty of guides and resources to help you navigate this exciting journey.</p>"},{"location":"getting-started/#elevating-to-admin-status","title":"Elevating to Admin Status","text":"<p>Congratulations on successfully logging into your Control Center! As a first-time user, you'll initially have standard user permissions. To fully harness the power of Control Center and manage your virtual airspace effectively, you'll need to elevate your account to admin status. This process is simple and requires just one command.</p> <p>Open the terminal in the same folder where you ran <code>docker compose</code> and execute the following command.</p> <pre><code>docker compose exec control-center php artisan user:makeadmin\n</code></pre> <ol> <li> <p>Confirm the Change: The script will ask for a VATSIM CID. Enter the demo CID <code>10000010</code>.</p> </li> <li> <p>Select an Area: Select one of the pre-defined areas. The script will confirm that your account has been elevated to admin status.</p> </li> <li> <p>Enjoy Full Access: Log back into the Control Center. You should now have full administrative access, allowing you to manage settings, users, and all aspects of the virtual air traffic control environment.</p> </li> </ol> Need Help? <p>If you encounter any issues while elevating your account to admin, don't hesitate to reach out on our forums. We're here to make your journey with Control Center smoother and enjoyable.</p> <p>By becoming an admin, you unlock the full potential of Control Center, giving you the power to shape and manage your virtual training just the way you want. Ready to take control? Let's fly high!</p>"},{"location":"getting-started/#ready-for-the-next-step","title":"Ready for the Next Step?","text":"<p>You've successfully started Control Center using Docker Compose! But wait, there's more. Head over to our installation guide to explore detailed setup options, configurations, and to dive deeper into the capabilities of Control Center. Your adventure in virtual air traffic management is just beginning, and we're here to guide you every step of the way.</p>"},{"location":"installation/","title":"Installation","text":"<p>Control Center is built using Laravel 10 and supports PHP 8.1+.</p>"},{"location":"installation/#installation","title":"Installation","text":""},{"location":"installation/#from-container","title":"from container recommended","text":"<ul> <li>A Docker environment to deploy containers. We recommend Portainer.</li> <li>A MySQL compatible database to store data.</li> <li>Preferably a reverse proxy setup if you plan to host more than one website on the same server.</li> </ul> <p>In the instructions where we use <code>docker exec</code>, we assume your container is named <code>control-center</code>. If you have named it differently, please replace this.</p> <p>Open up a terminal and pull the latest image with:</p> <pre><code>docker pull ghcr.io/vatsim-scandinavia/control-center:v4\n</code></pre> <p>If you're not familiar with Docker, don't worry. We'll walk you through the initial setup.</p>"},{"location":"installation/#from-source","title":"from source not recommended","text":"<p>If you don't want to use Docker, you need:</p> <ul> <li>An environment that can host PHP websites, such as Apache, Nginx or similar.</li> <li>A MySQL compatible database to store data.</li> <li>Comply with Laravel 10 Requirements.</li> </ul> <p>In addition, you must handle the following additional tasks:</p> <ul> <li>Manually build the composer and npm project.</li> <li>Configure cron jobs.</li> <li>Manually clear all all caches on updates.</li> </ul>"},{"location":"installation/#next-steps","title":"Next steps","text":"<p>With either a container-based installation or the source code, you can now configure the essential parts of the Control Center instance.</p>"},{"location":"upgrade/","title":"Upgrading","text":"<p>Updating between minor versions only requires you to run migration and clear caches. Remember to run the theme build again if you have a custom theme.</p> <p>Once done, you must migrate the database changes and clear the cache:</p> <pre><code>php artisan migrate\nphp artisan optimize:clear\n</code></pre> <p>Executing commands in containers</p> <p>If you're using a container you need to use execute the command inside of the container. For example, if you're using Docker you must prefix the command with <code>docker exec</code> and specify the container name. Here's an example where we assume that the container is <code>control-center</code>:</p> <pre><code>docker exec -it --user www-data control-center COMMAND [ARGUMENTS...]\n</code></pre>"},{"location":"why/","title":"Why use Control Center","text":"<p>Handling training requests and keeping a VATSIM Area Control Centre (or multiple!) active takes a lot of work. Control Center is built on the idea of reducing the amount of work, while also making the experience faster and enjoyable.</p> <ul> <li>Handle training flow of virtual Air Traffic Controllers (ATC)</li> <li>Set and maintain custom activity targets for ATCs, and mark ATCs that fall under the target as inactive</li> <li>Clean up members, trainings and exams in the event of account closure</li> <li>GDPR compliant</li> </ul>"},{"location":"concepts/","title":"Using Control Center","text":""},{"location":"concepts/training/","title":"Training","text":""},{"location":"concepts/training/#maintain-activity","title":"Maintain activity","text":"<p>All trainings with status In Queue or Pre-Training are given a continued interest request each month, and a reminder after a week.</p> <p>Warning</p> <p>Failing to reply within two weeks closes the request automatically.</p>"},{"location":"configuration/","title":"Initial configuration","text":"<p>To get Control Center running and have it reflect your division as you wish, there are several environment variables you must customise.</p>"},{"location":"configuration/#environment","title":"Setting up the environment","text":"<p>You may start the container with <code>docker-compose.yaml</code> from the root folder, but fill it out with the required variables first.</p>"},{"location":"configuration/#environment-variables","title":"Environment variables","text":"<p>Tables with all the variables, default value and explanation. Override the environment variable to change the value if the default value does not fit your needs.</p>"},{"location":"configuration/#basics","title":"Basics","text":"<p>Settings related to URLs, subdivision names and other core application settings.</p> Variable Default value Explanation <code>APP_NAME</code> Control Center Name of your subdivision <code>APP_OWNER</code> Subdivision Name Name of your subdivision <code>APP_OWNER_SHORT</code> SCA Usually 3 letter name identifying your vACC within VATSIM API <code>APP_URL</code> http://localhost URL to your Control Center <code>APP_ENV</code> production Environment of your Control Center"},{"location":"configuration/#database","title":"Database","text":"<p>Important</p> <p>The database settings must be valid to get access to Control Center.</p> <p>Settings related to configuring the database connection.</p> Variable Default value Explanation <code>DB_CONNECTION</code> mysql Database connection type <code>DB_HOST</code> localhost Database host <code>DB_PORT</code> 3306 Database port <code>DB_DATABASE</code> control-center Database name <code>DB_USERNAME</code> root Database username <code>DB_PASSWORD</code> root Database password <code>DB_TABLE_PREFIX</code> null Database table prefix"},{"location":"configuration/#authentication-vatsimhandover","title":"Authentication (VATSIM/Handover)","text":"<p>Important</p> <p>The authentication settings must be valid to get access to Control Center.</p> <p>Settings related to configuring OAuth-based authentication adhering to the fields supported by VATSIM and Handover.</p> Variable Default value Explanation <code>OAUTH_URL</code> https://auth.vatsim.net OAuth URL of VATSIM <code>OAUTH_ID</code> null OAuth ID of your subdivision <code>OAUTH_SECRET</code> null OAuth secret of your subdivision <p>Other OAuth providers</p> <p>It's possible to setup your own OAuth provider with Control Center.</p>"},{"location":"configuration/#vatsim","title":"VATSIM","text":"<p>Important</p> <p>The VATSIM settings must be valid for the membership tasks and bookings to function.</p> <p>Settings related to the VATSIM integration.</p> Variable Default value Explanation <code>VATSIM_API_TOKEN</code> null Token to VATSIM API <code>VATSIM_BOOKING_API_URL</code> https://atc-bookings.vatsim.net/api URL to VATSIM Booking API <code>VATSIM_BOOKING_API_TOKEN</code> null Token to VATSIM Booking API"},{"location":"configuration/#mail","title":"Mail","text":"<p>Settings related to mail notifications, an important aspect of supporting training.</p> Variable Default value Explanation <code>MAIL_MAILER</code> smtp Mailer type <code>MAIL_HOST</code> smtp.mailgun.org Mail host <code>MAIL_PORT</code> 587 Mail port <code>MAIL_USERNAME</code> null Mail username <code>MAIL_PASSWORD</code> null Mail password <code>MAIL_ENCRYPTION</code> null Mail encryption <code>MAIL_FROM_NAME</code> Control Center Mail from name <code>MAIL_FROM_ADDRESS</code> noreply@yourvacc.com Mail from address"},{"location":"configuration/#proxying","title":"Proxying","text":"<p>Settings related to reverse proxies in front of Control Center.</p> Variable Default value Explanation <code>TRUSTED_PROXIES</code> null Comma-separated list of trusted proxy addresses or '*' for all"},{"location":"configuration/#configuring-authentication-with-oauth","title":"Configuring authentication with OAuth","text":"<p>Control Center supports both VATSIM Connect, Handover and other OAuth providers to authenticate and fetch user data. If you're looking for a centrailised login system check out our Handover service, or use VATSIM Connect.</p> <p>Note: No explicit configuration is required for VATSIM Connect or Handover.</p> <p>If you use your own custom Oauth provider, you need to configure the following variables.</p>"},{"location":"configuration/#environment-variables_1","title":"Environment variables","text":"Variable Your OAuth provider array path Explanation OAUTH_MAPPING_CID data-id OAuth mapping of VATSIM CID OAUTH_MAPPING_EMAIL data-email OAuth mapping of VATSIM e-mail OAUTH_MAPPING_FIRSTNAME data-first_name OAuth mapping of VATSIM first name OAUTH_MAPPING_LASTNAME data-last_name OAuth mapping of VATSIM last name OAUTH_MAPPING_RATING data-vatsim_details-controller_rating-id OAuth mapping of VATSIM rating OAUTH_MAPPING_RATING_SHORT data-vatsim_details-controller_rating-short OAuth mapping of VATSIM rating short OAUTH_MAPPING_RATING_LONG data-vatsim_details-controller_rating-long OAuth mapping of VATSIM rating long OAUTH_MAPPING_REGION data-vatsim_details-region OAuth mapping of VATSIM region OAUTH_MAPPING_DIVISION data-vatsim_details-division OAuth mapping of VATSIM division OAUTH_MAPPING_SUBDIVISION data-vatsim_details-subdivision OAuth mapping of VATSIM subdivision"},{"location":"configuration/#optional-extras","title":"Optional: Extras","text":"Variable Default value Explanation APP_DEBUG false Toggle debug mode of your Control Center APP_TRACKING_SCRIPT null Input javascript here with your tracking script, e.g. Google Analytics DEBUGBAR_ENABLED false Toggle debug bar of your Control Center SESSION_LIFETIME 120 Session lifetime in minutes, forces a new login when passed SENTRY_LARAVEL_DSN null The Sentry DSN SENTRY_TRACES_SAMPLE_RATE 0.1 The Sentry sample rate"},{"location":"configuration/system/","title":"Configure the instance","text":"Upgrading from v3.4 to v4.0? <p>Read the UPGRADE.md in v4.0 documentation for details about breaking changes and migration notes.</p> Using a container <p>These instructions assume you're using a container. Although most steps are the same if you're running from source, some passages or instructions might not make as much sense.</p> <p>We've assumed that you've fetched Control Center and installed it. If you haven't, now is the time.</p> <p>Executing commands in containers</p> <p>If you're using a container you need to use execute the command inside of the container. For example, if you're using Docker you must prefix the command with <code>docker exec</code> and specify the container name. Here's an example where we assume that the container is <code>control-center</code>:</p> <pre><code>docker exec -it --user www-data control-center COMMAND [ARGUMENTS...]\n</code></pre>"},{"location":"configuration/system/#1-initial-database-setup","title":"1. Initial database setup","text":"Database not included <p>A MySQL-compatible database is not included in the container or in the source code. You must run your own database, whether separately, locally or with container orchestrators such as Docker Compose.</p> <p>First make sure that you've started Control Center in the background or you are in the folder with the source.</p> <p>Run the migration script:</p> dockerdocker composesource <pre><code>docker exec -it control-center php artisan migrate\n</code></pre> <pre><code>docker compose exec control-center php artisan migrate\n</code></pre> <pre><code>php artisan migrate\n</code></pre>"},{"location":"configuration/system/#2-create-application-key","title":"2. Create application key","text":"<p>To secure your application, as well as prevent users from needing to log in between restarts, you must create and expose an application key to your Control Center instance.</p> dockerdocker composesource <pre><code>docker exec -it control-center php artisan key:get\n</code></pre> <pre><code>docker compose exec control-center php artisan key:get\n</code></pre> <p>Session storage needs to be configured in your <code>docker-compose.yml</code> by adding a volume.</p> <pre><code>php artisan key:get\n</code></pre> <p>Note that sessions will be stored locally in the source folder. To keep sessions across different installations, it is recommended to either mount or symlink them to a different location.</p> <p>Copy the key and set it as the <code>APP_KEY</code> environment variable in your environment variable configuration.</p> <p>Sensitive information</p> <p>The application key is a secret string which must be kept confidential.</p>"},{"location":"configuration/system/#3-mount-sessions-file-storage","title":"3. Mount sessions &amp; file storage","text":"<p>Unless otherwise configured, Control Center stores sessions and uploaded files locally in text files. These must be available across restarts for Control Center to remember previously logged-in users.</p>"},{"location":"configuration/system/#sessions","title":"Sessions","text":"dockerdocker composesource <pre><code>docker volume create controlcenter_sessions\n</code></pre> <p>While possible, it is much easier to bind the volume to the container by recreating it. The container must be recreated to bind the volume when creating the container with <code>controlcenter_sessions:/app/storage/framework/sessions</code>.</p> <pre><code>docker run [other arguments] --volume controlcenter_sessions:/app/storage/framework/sessions control-center\n</code></pre> <p>Add an additional volume to Control Center in your <code>docker-compose.yml</code> to configure session storage. It's possible to choose between a new volume and a volume mount to the host filesystem.</p> <pre><code># ...\nservices:\n  control-center:\n   # other control-center settings not included\n    volumes:\n      - controlcenter_sessions:/app/storage/framework/sessions\n# ...\nvolumes:\n  controlcenter_sessions:\n    driver: local\n</code></pre> <p>Installations from source will by default store sessions locally in <code>storage/framework/sessions</code>. To keep sessions across different installations, it is recommended to either mount or symlink them to a different location.</p>"},{"location":"configuration/system/#uploaded-files","title":"Uploaded files","text":"<p>To keep uploaded files between deployments, you need to keep the upload folder and its files available to Control Center across deployments.</p> dockerdocker composesource <p>Bind the uploaded files folder directly to a location on the host filesystem. Again, while possible, it is much easier to bind the volume to the container by recreating it:</p> <pre><code>docker run [other arguments] --volume /YOUR/HOST/LOCATION:/app/storage/app/public/files control-center\n</code></pre> <p>Add an additional volume mount to Control Center in your <code>docker-compose.yml</code>.</p> <pre><code>volumes:\n  - /YOUR/SAFE/HOST/LOCATION:/app/storage/app/public/files\n</code></pre> <p>Ensure correct file permissions after bringing the Compose stack down and up again:</p> <pre><code>docker compose exec control-center chown -R www-data:www-data /app/storage/app/public/files\n</code></pre> <p>Installations from source will by default store uploaded files locally in <code>storage/app/public/files</code>. To keep uploaded files safe, it is strongly recommended to either mount or symlink them to a different location with sufficient backups.</p> <p>Ensure the file permissions on your system are correct. For example, if you're running with Apache2 on Ubuntu you might need to change the ownership of the <code>storage/app/public/files</code> to <code>www-data:www-data</code>.</p>"},{"location":"configuration/system/#4-background-jobs","title":"4. Background jobs","text":"<p>For background jobs to run there needs to be something that makes them run. Control Center is written in PHP and does not come with its own standalone task worker or supervisor.</p> <p>You must configure a crontab or create a SystemD timer to run the scheduler every minute.</p> <p>SystemD and crontab</p> <p>We recommend you use SystemD, but a simple crontab (with the schedule <code>* * * * *</code>) is also possible.</p>"},{"location":"configuration/system/#create-the-systemd-units","title":"Create the SystemD units","text":"<p>Create two units to run Control Center's scheduled tasks. The service is responsible for starting our background jobs, and can be run on-demand, whereas the timer is responsible for starting the service.</p> /etc/systemd/control-center-tasks.service<pre><code>[Unit]\nDescription=Process Control Center background jobs\n\n[Service]\nType=oneshot\nWorkingDirectory=/PATH/TO/CONTROL/CENTER # (1)!\nExecStart=COMMAND # (2)!\n</code></pre> <ol> <li>This path should either point to the folder where you have your Docker configuration or your source installation.</li> <li>Insert the relevant command from the <code>COMMAND</code> tabs underneath.</li> </ol> /etc/systemd/control-center-tasks.timer<pre><code>[Unit]\nDescription=Run Control Center's task scheduler every minute\n\n[Timer]\nOnCalendar=*-*-* *:*:00\nPersistent=true\n\n[Install]\nWantedBy=timers.target\n</code></pre> dockerdocker composesource COMMAND<pre><code>docker exec --user www-data -i control-center php artisan schedule:run\n</code></pre> <p>This executes the task scheduler inside the running container.</p> <p>You can either edit the service to be executed in the folder with your <code>docker-compose.yml</code> by editing <code>WorkingDirectory</code> above, or you can identify the name of the container and use <code>docker</code> directly.</p> COMMAND<pre><code>docker exec --user www-data -i control-center php artisan schedule:run\n</code></pre> <p>You must correctly specify <code>WorkingDirectory</code> in <code>control-center-tasks.service</code> and identify the path to your PHP installation.</p> <p>Here we have assumed you can use <code>/usr/bin/env</code> to run your PHP installation:</p> COMMAND<pre><code>/usr/bin/env php artisan schedule:run\n</code></pre>"},{"location":"configuration/system/#enable-the-service-timer","title":"Enable the service timer","text":"<p>Start the service to verify that your service is working. To start the service:</p> <pre><code>systemctl start control-center-tasks.service\n</code></pre> <p>Whether it succeeds or fails, on a healthy system you can read the logs by using <code>journalctl</code>:</p> <pre><code>journalctl -u control-center-tasks.service\n</code></pre> <p>Great! You've now tested that background jobs can run. Let's enable the timer so it's run every minute.</p> <pre><code>systemctl enable --now control-center-tasks.timer\n</code></pre> <p>Note that we enabled the <code>.timer</code> (not the service!) and told SystemD to start it now<sup>1</sup>.</p> <p>Great, let's continue on.</p>"},{"location":"configuration/system/#5-reverse-proxy","title":"5. Reverse proxy","text":"<p>While not required, Control Center expects that you run a web server or reverse proxy in front of it. For the time being, this is where we recommend you terminate SSL/TLS connections between your instance and your users.</p> <p>The process for setting up a reverse proxy depends on the software you use and your needs.</p> <p>Bind the ports <code>8080</code> (HTTP) and/or <code>8443</code> (HTTPS) port to your reverse proxy.</p>"},{"location":"configuration/system/#6-promote-a-user-to-admin","title":"6. Promote a user to admin","text":"<p>You're almost there! The only step that remains is to promote the first administrator. You can add multiple administrators, and you can add them at any time.</p> <p>Find your own VATSIM CID, and have it ready:</p> dockerdocker composesource <pre><code>docker exec -it control-center php artisan user:makeadmin\n</code></pre> <pre><code>docker compose exec control-center php artisan user:makeadmin\n</code></pre> <pre><code>php artisan user:makeadmin\n</code></pre> <p>You'll be asked to provide a CID and an area that the user is an administrator in. Assuming you change the areas to ones of your own, selecting the first area means you won't need to repeat this process right after customising your subdivision's areas.</p>"},{"location":"configuration/system/#next-steps","title":"Next steps","text":"<p>You're done! You can now access Administration -&gt; Settings from the navigation menu to change the essential division preferences.</p> <p>You have</p> <ul> <li> setup a database for CC</li> <li> secured your application instance</li> <li> secured your users sessions and data</li> <li> sorted scheduled tasks</li> <li> considered or added a reverse proxy</li> <li> a great starting-point to get your division on-board!</li> </ul> <ol> <li> <p>To check the status of the timer (or the service) you can use <code>systemctl status</code>:</p> <p><pre><code>systemctl status control-center-tasks.timer\n</code></pre> \u21a9</p> </li> </ol>"},{"location":"setup/authentication/","title":"Configuring authentication with OAuth","text":"<p>Only applies if you're not using Handover or VATSIM Connect</p> <p>These settings do not apply if you're using Handover or VATSIM Connect to authenticate your users.</p> <p>Control Center supports both VATSIM Connect, Handover and other OAuth providers to authenticate and fetch user data.</p> <p>If you're looking for a centralised authentication service, check out our Handover service, or use VATSIM Connect.</p> <p>While support for VATSIM Connect and Handover is configured by default, there are additional settings you need to configure for Control Center to work with other OAuth-based identity providers.</p> <p>Use VATSIM Connect or Handover if possible</p> <p>No explicit configuration is required for VATSIM Connect or Handover. Consider using either VATSIM SSO or Handover for authentication by utilising the standard configuration.</p>"},{"location":"setup/authentication/#environment-variables","title":"Environment variables","text":"<p>If you want to use your own custom OAuth provider, you need to configure the following variables.</p> Variable Your OAuth provider array path Explanation OAUTH_MAPPING_CID data-id OAuth mapping of VATSIM CID OAUTH_MAPPING_EMAIL data-email OAuth mapping of VATSIM e-mail OAUTH_MAPPING_FIRSTNAME data-first_name OAuth mapping of VATSIM first name OAUTH_MAPPING_LASTNAME data-last_name OAuth mapping of VATSIM last name OAUTH_MAPPING_RATING data-vatsim_details-controller_rating-id OAuth mapping of VATSIM rating OAUTH_MAPPING_RATING_SHORT data-vatsim_details-controller_rating-short OAuth mapping of VATSIM rating short OAUTH_MAPPING_RATING_LONG data-vatsim_details-controller_rating-long OAuth mapping of VATSIM rating long OAUTH_MAPPING_REGION data-vatsim_details-region OAuth mapping of VATSIM region OAUTH_MAPPING_DIVISION data-vatsim_details-division OAuth mapping of VATSIM division OAUTH_MAPPING_SUBDIVISION data-vatsim_details-subdivision OAuth mapping of VATSIM subdivision"},{"location":"setup/division/","title":"Define the division","text":""},{"location":"setup/division/#database","title":"Database","text":"<p>Here you find the diffrerent data tables which need to be edited to suit your subdivision. Perform the changes in the same order as this document.</p>"},{"location":"setup/division/#areas","title":"Areas","text":"<p>In <code>Areas</code> table, create one or more areas. This is something student select between when applying for trianing.</p> id name contact template_newreq template_newmentor template_pretraining template_s1_positions x Name Contact e-mail that will be displayed to students Can be set in Notification Editor, set NULL Same as last Same as last Comma seperated positions for fast filling when grating endorsements 1 Norway training-norway@vatsim-scandinavia.org NULL NULL NULL ENBR_DEL,ENBR_GND"},{"location":"setup/division/#ratings","title":"Ratings","text":"<p>In <code>Ratings</code> table, the default VATSIM ratings are present and if applicable, the endorsement ratings.</p> id name description vatsim_rating x Rating Name Description The id of vatsim rating this represents, NULL if local endorsement 1 S1 Rating required to sit GND position 2 8 MAE MAJOR AIRPORT Rating required to sit on a selected airport NULL"},{"location":"setup/division/#ratings-in-areas","title":"Ratings in areas","text":"<p>In <code>area_rating</code> table, we define which ratings are available for which area for applications. If a rating is only applicable manually through a moderator there's no need to add it here.</p> area_id rating_id required_vatsim_rating allow_bundling hour_requirement queue_length_low queue_lenght_high id of area id of rating Id of required vatsim rating to apply for the id of this rating in selected area NULL or 1 (true) if this vatsim rating can be bundled with a GRP VATSIM rating NULL or number of hours required to apply for this rating Filled in by automation Filled in by automation 1 2 NULL NULL NULL NULL NULL 1 3 3 NULL 50 NULL NULL"},{"location":"setup/division/#positions","title":"Positions","text":"<p>In <code>positions</code> table, we define which positions are possible to book and their restrictions.</p> id callsign frequency name fir area rating mae x The callsign Name of position showed when booking optional frequency, not used inside CC for now Used for filtering in bookings id of area vatsim rating id required to book position Is this a endorsement position? 1 ENBR_TWR Flesland Tower NULL ENOR 4 3 NULL 2 ENGM_TWR Gardermoen Tower NULL ENOR 4 3 1"},{"location":"setup/logo/","title":"Changing the logo","text":"<p>If you'd like to change the division logo to your division's logo, you must put the logo inside of Control Center. You can do this with binding or by creating your own variant of Control Center.</p> BindingCustom container <p>Bind your logo image files to <code>public/images/logos</code>.</p> <p>[Create a variant of Control Center][custom.md] and add your logos to <code>public/images/logos</code>.</p> Variable Default value Explanation APP_LOGO vatsca.svg The logo of your subdivision, located in <code>public/images/logos</code> APP_LOGO_MAIL vatsca-email.png The logo of your subdivision, located in <code>public/images/logos</code>"},{"location":"setup/theme/","title":"Changing the colours & borders","text":"<p>To change the bootstrap colors to match your division, first change the environment variables and then run the following command</p> Variable Default value Explanation VITE_THEME_PRIMARY #1a475f Primary color of your theme VITE_THEME_SECONDARY #484b4c Secondary color of your theme VITE_THEME_TERTIARY #011328 Tertiary color of your theme VITE_THEME_INFO #17a2b8 Info color of your theme VITE_THEME_SUCCESS #41826e Success color of your theme VITE_THEME_WARNING #ff9800 Warning color of your theme VITE_THEME_DANGER #b63f3f Danger color of your theme VITE_THEME_BORDER_RADIUS 2px Border radius of your theme <p>Run this command to build the theme. If you get an error like <code>\"#5f271a\" is not a color</code>, remove the <code>\"</code> quotes from your environment variable.</p> <pre><code>docker exec -it control-center sh container/theme/build.sh\n</code></pre> <p>Note 1. Building custom themes will increase your container size with ~200mb when completed. When you run this command, we need install dependencies inside your container to build the theme and then remove them again. This is done to keep the container size down. 2. You need to run this command each time you recreate the container.</p>"}]}